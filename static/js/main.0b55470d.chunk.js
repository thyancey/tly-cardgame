(this["webpackJsonptly-react-2020"]=this["webpackJsonptly-react-2020"]||[]).push([[0],{20:function(n,t,e){n.exports=e(28)},25:function(n,t,e){},28:function(n,t,e){"use strict";e.r(t);var r=e(0),o=e.n(r),a=e(11),c=e.n(a),u=(e(25),e(1)),i=e(4),d=e(2),l=o.a.createContext({holdingIdx:0,deck:[],hand:[]}),s=e(3),f={DECK:0,HAND:1,HAND_HOLDING:2,TABLE:3,TABLE_HOLDING:4,DISCARDED:5};e(12);var b=function(n){return h.color[n]},m="400px",g="500px",p="768px",v="1024px",h=("(min-width: ".concat("300px",")"),"(min-width: ".concat(m,")"),"(min-width: ".concat(g,")"),"(min-width: ".concat(p,")"),"(min-width: ".concat(v,")"),{color:{black:"#000000",grey:"#373737",grey_light:"#A39F8E",white:"#ffffff",blue:"#225C87",green:"#238845",yellow:"#688722",orange:"#688722",purple:"#5E238C",pink:"#85227E",ui_blue:"#20F3FF",ui_orange:"#FD9410",ui_yellow:"#FDE010",ui_green:"#10FD21"},shadow:{z1:"-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.16)",z2:"-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.36)",z3:"-.2rem .5rem 1rem .2rem rgba(0,0,0,.36)"},value:{headerHeight:"7.5rem",menuWidth:"12rem"},mixins:{},breakpoints:{mobile_tiny:"300px",mobile_medium:"400px",mobile_large:"500px",tablet:"768px",desktop:"1024px"}});function O(){var n=Object(u.a)(["\n  color:white;\n  position:absolute;\n  bottom:100%;\n"]);return O=function(){return n},n}function x(){var n=Object(u.a)(["\n  background-size: contain;\n  width:100%;\n  height:100%;\n  border-radius:1rem;\n"]);return x=function(){return n},n}function j(){var n=Object(u.a)(["\n    transform: scaleX(1.5) scaleY(1.5);\n    opacity: .5;\n    transition: transform .1s cubic-bezier(.42,.05,.86,.13), opacity .2s;\n  "]);return j=function(){return n},n}function k(){var n=Object(u.a)(["\n    box-shadow: 1px 3px 2px 4px ",";\n  "]);return k=function(){return n},n}function C(){var n=Object(u.a)(["\n    box-shadow: 1px 3px 2px 4px ",";\n  "]);return C=function(){return n},n}function E(){var n=Object(u.a)(["\n    left: -5rem;\n    top: -7.5rem;\n  "]);return E=function(){return n},n}function w(){var n=Object(u.a)(["\n    left: 0;\n    top: 0;\n  "]);return w=function(){return n},n}function I(){var n=Object(u.a)(["\n  position:absolute;\n  width:10rem;\n  height:15rem;\n  transform-origin: 50% 50%;\n  ","\n  \n  transition: transform .3s cubic-bezier(1,.05,.32,1.2), opacity .3s;\n  border-radius: 1rem;\n  \n  box-shadow: ",";\n  ","\n  ","\n\n  ","\n"]);return I=function(){return n},n}function y(){var n=Object(u.a)(["\n    position:absolute;\n  "]);return y=function(){return n},n}function D(){var n=Object(u.a)(["\n    display:inline-block;\n    position:relative;\n    width:10rem;\n    height:15rem;\n    top:-5rem;\n  "]);return D=function(){return n},n}function S(){var n=Object(u.a)(["\n    z-index:1000;\n  "]);return S=function(){return n},n}function R(){var n=Object(u.a)(["\n  background-color: ",";\n  border-radius:1rem;\n  color:black;\n  cursor:pointer;\n  z-index: ",";\n  ","\n\n  ","\n"]);return R=function(){return n},n}var B,M={};M.Card=d.b.div(R(),(function(n){return n.theme||"white"}),(function(n){return n.depth}),(function(n){return n.isDragging&&Object(d.a)(S())}),(function(n){return n.inHand?Object(d.a)(D()):Object(d.a)(y())})),M.InnerCard=d.b.div(I(),(function(n){return n.inHand?Object(d.a)(w()):Object(d.a)(E())}),(B="z3",h.shadow[B]),(function(n){return"stacked"===n.stackStyle&&Object(d.a)(C(),b("ui_blue"))}),(function(n){return"focused"===n.stackStyle&&Object(d.a)(k(),b("ui_green"))}),(function(n){return n.isDragging&&Object(d.a)(j())})),M.Background=d.b.img(x()),M.DebugStatus=d.b.p(O());var A=function(n){var t,e=n.onMouseDown,r=n.onMouseOver,a=n.position,c=n.cardRef,u=n.stackStyle,i=n.dragPosition,d=n.inHand,l=n.data,s=n.theme,b=void 0===s?"white":s;return o.a.createElement(M.Card,{id:"card-".concat(l.cardIdx),theme:b,isDragging:!!i,onMouseDown:function(n){return e(n,l.cardIdx)},onMouseOver:function(n){return r(n,l.cardIdx,l.stackIdx)},depth:l.layer,ref:c,inHand:d,style:d?null:{left:"".concat(a.x,"px"),top:"".concat(a.y,"px")}},o.a.createElement(M.InnerCard,{isDragging:!!i,inHand:d,stackStyle:u},o.a.createElement(M.DebugStatus,null,(t=l.status,Object.keys(f).find((function(n){return f[n]===t}))||"NULL")),o.a.createElement(M.Background,{src:l.info.imageUrl,draggable:!1})))};var L=function(n){var t=n.data,e=n.theme,a=void 0===e?"white":e,c=Object(r.useContext)(l),u=c.actions,d=c.focusedStackIdx,b=Object(r.useState)({dragPosition:null,activeListener:!1}),m=Object(i.a)(b,2),g=m[0],p=m[1],v=Object(r.useRef)(null),h=Object(r.useCallback)((function(n,t,e){u.setFocusedCardIdx(t),u.setFocusedStackIdx(e,{x:n.clientX,y:n.clientY})}),[u.setFocusedStackIdx,u.setFocusedCardIdx]),O=Object(r.useCallback)((function(n,t){var e=n.clientX,r=n.clientY;u.holdCard(t),p((function(n){return Object(s.a)(Object(s.a)({},n),{},{activeListener:!0,dragPosition:{x:e,y:r}})}))}),[u.holdCard]),x=Object(r.useCallback)((function(n){var t=n.clientX,e=n.clientY;p((function(n){return Object(s.a)(Object(s.a)({},n),{},{dragPosition:{x:t,y:e}})}))}),[]),j=Object(r.useCallback)((function(n){var e=n.clientX,r=n.clientY;p((function(n){return Object(s.a)(Object(s.a)({},n),{},{activeListener:!1,dragPosition:null})})),u.dropCard(t.cardIdx,"TABLE",{x:e,y:r})}),[t.cardIdx,u.dropCard]);Object(r.useEffect)((function(){g.activeListener?(v.current.addEventListener("mouseleave",j),v.current.addEventListener("mousemove",x),v.current.addEventListener("mouseup",j)):(v.current.removeEventListener("mouseleave",j),v.current.removeEventListener("mousemove",x),v.current.removeEventListener("mouseup",j))}),[g.activeListener]),Object(r.useEffect)((function(){g.initialized||p((function(n){return Object(s.a)(Object(s.a)({},n),{},{activeListener:!0,dragPosition:{x:t.position.x,y:t.position.y}})}))}),[g.initialized]);var k,C,E=(k=t.position,C=g.dragPosition,t.status===f.HAND?{x:0,y:0}:C?{x:C.x,y:C.y}:{x:k.x,y:k.y}),w=Object(r.useMemo)((function(){return-1===t.stackIdx?null:d===t.stackIdx?"focused":"stacked"}),[t.stackIdx,d]);return o.a.createElement(A,{data:t,theme:a,onMouseDown:O,onMouseOver:h,cardRef:v,inHand:!1,position:E,dragPosition:g.dragPosition,stackStyle:w})},z=50,T=75,H=["A","B","C","D","E","F","G","H","I","J","K","L"],P={isThisInThat:function(n,t){return!(!n||!t)&&n.findIndex((function(n){return t.indexOf(n)>-1}))>-1},mergeArrays:function(n,t){return t=t||[],(n=n||[]).concat(t.filter((function(t){return n.indexOf(t)<0})))},produceBounds:function(n){return{left:n.x-z,top:n.y-T,right:n.x+z,bottom:n.y+T}},createBoundedHand:function(n){return n.filter((function(n){return n.status===f.TABLE})).map((function(n){return{cardIdx:n.cardIdx,bounds:P.produceBounds(n.position)}}))},doesOverlap:function(n,t){return n.top<=t.bottom&&n.bottom>=t.top&&n.left<=t.right&&n.right>=t.left},getGroupPairs:function(n){for(var t=[],e=0;e<n.length;e++)for(var r=e+1;r<n.length;r++)P.doesOverlap(n[e].bounds,n[r].bounds)&&t.push([n[e].cardIdx,n[r].cardIdx]);return t},createRawStacks:function(n){if(!n||0===n.length)return[];for(var t=[],e=n.slice();e.length>0;){var r=P.mutateForGroupPairs(t,e);t=r.stacks,e=r.groupPairs}return t},findStackWithMatch:function(n,t){return n.findIndex((function(n){return n.indexOf(t[0])>-1||n.indexOf(t[1])>-1}))},calcStacks:function(n){var t=P.createBoundedHand(n),e=P.getGroupPairs(t);return P.createRawStacks(e)},mutateForGroupPairs:function(n,t){for(var e=!1,r=t.length-1;r>=0;r--){var o=P.findStackWithMatch(n,t[r]);0===n.length?(n.push(t[r]),t.splice(r,1),e=!0):o>-1&&(n[o]=P.mergeArrays(n[o],t[r]),t.splice(r,1),e=!0)}return!e&&t.length>0&&n.push(t[t.length-1]),{stacks:n,groupPairs:t}},getStackColor:function(n){switch(n){case-1:return null;case 0:return"purple";case 1:return"blue";case 2:return"green";case 3:return"yellow";case 4:return"red";case 5:return"grey";default:return"black"}},getStackLabel:function(n){return H[n]||"*"}},F=function(n,t){var e=function(n,t){return n.map((function(n){return t.find((function(t){return t.cardIdx===n}))}))}(n,t),r=[],o=[];return e.forEach((function(n){n.info.meta.forEach((function(n){var t,e,a=r.findIndex((function(t){return t.tag===n.tag}));a>-1?r[a].value===n.value?r[a]=(e=r[a],Object(s.a)(Object(s.a)({},e),{},{count:e.count+1})):-1===o.indexOf(n.tag)&&o.push(n.tag):r.push({tag:(t=n).tag,value:t.value,score:t.score,count:1})}))})),r.filter((function(n){return t=n.tag,!o.some((function(n){return n===t}));var t})).filter((function(t){return t.count===n.length}))},N=function(n,t){return n.map((function(n){var e=t.find((function(t){return t.cardIdx===n}));return Object(s.a)(Object(s.a)({},e.info),{},{layer:e.layer})})).sort((function(n,t){return n.layer>t.layer?1:-1}))},_=function(n){return n.reduce((function(n,t){return t.score+n}),0)},Z=function(n,t){return t>0&&Math.round(n/t)||0},G=function(n,t){return n.map((function(n,e){var r=F(n,t);return{idx:e,cardIdxs:n,cardDetails:N(n,t),count:n.length,meta:r,subScore:r.reduce((function(n,t){return n+t.score}),0),score:r.reduce((function(n,t){return n+t.count*t.score}),0)}}))};function W(){var n=Object(u.a)(["\n  position:absolute;\n  padding-top: 1rem;\n  top:100%;\n  width:100%;\n  left:0;\n  text-align:center;\n  color:","\n"]);return W=function(){return n},n}function U(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:-1;\n  left:0;\n  top:0;\n  right:0;\n  bottom:0;\n  border-radius: 2rem;\n  border: 1rem solid white;\n"]);return U=function(){return n},n}function X(){var n=Object(u.a)(["\n  padding: .5rem 1.5rem;\n  font-size: 1rem;\n  background-color: ",";\n  border-radius: 1rem;\n  width: 100%;\n  font-weight: bold;\n  cursor:pointer;\n\n  border: .5rem solid ",";\n  color:",";\n  &:first-child{\n    margin-top:0;\n  }\n  margin-top: .5rem;\n\n  &:hover{\n    background-color: ",";\n    /* color:","; */\n    box-shadow: 0 0 1rem .2rem white;\n  }\n"]);return X=function(){return n},n}function Y(){var n=Object(u.a)(["\n  width:15rem;\n  min-height:22rem;\n  padding:2rem;\n"]);return Y=function(){return n},n}var J={};J.Container=d.b.div(Y()),J.BasicButton=d.b.div(X(),b("purple"),b("white"),b("white"),b("green"),b("blue")),J.Bg=d.b.div(U()),J.ZoneText=d.b.p(W(),b("white"));var K=function(){var n=Object(r.useContext)(l).actions;return o.a.createElement(J.Container,null,o.a.createElement(J.BasicButton,{onClick:function(){return n.dealHand()},role:"button"},"DEAL"),o.a.createElement(J.BasicButton,{onClick:function(){return n.dealCard(1)},role:"button"},"DRAW 1 MORE"),o.a.createElement(J.BasicButton,{onClick:function(){return n.discardHand()},role:"button"},"DISCARD ALL"),o.a.createElement("hr",null),o.a.createElement(J.BasicButton,{onClick:function(){return n.dealCard(10)},role:"button"},"HIT 10"),o.a.createElement(J.BasicButton,{onClick:function(){return n.discardRandomCard()},role:"button"},"DISCARD RANDOM"),o.a.createElement(J.ZoneText,null,"DRAW"),o.a.createElement(J.Bg,null))},V=e(16),q=e(17),$=e(6),Q=e(19),nn=e(18);function tn(){var n=Object(u.a)(["\n  width: 100%;\n  height: 100%;\n  p{\n    opacity:0;\n    color: white;\n    transition: opacity .1s;\n    text-align:left;\n    margin-left:1rem;\n  }\n  transition: box-shadow 1s;\n\n  &:hover{\n    box-shadow: 0 0 1rem .2rem white;\n    transition-delay: .5s;\n    p{\n      opacity:1;\n      transition: opacity 1s;\n      transition-delay: .7s;\n    }\n  }\n"]);return tn=function(){return n},n}var en={};en.Container=d.b.div(tn());var rn=function(n){Object(Q.a)(e,n);var t=Object(nn.a)(e);function e(n){var r;return Object(V.a)(this,e),(r=t.call(this,n)).zoneRef=o.a.createRef(),r.onWindowResize=r.onWindowResize.bind(Object($.a)(r)),r}return Object(q.a)(e,[{key:"componentDidMount",value:function(){var n,t;window.addEventListener("resize",this.onWindowResize),this.context.actions.setZone("hand",null===(n=this.zoneRef)||void 0===n||null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"onWindowResize",value:function(){var n,t;this.context.actions.setZone("hand",null===(n=this.zoneRef)||void 0===n||null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect())}},{key:"render",value:function(){return o.a.createElement(en.Container,{ref:this.zoneRef},o.a.createElement("p",null,"Return card to hand"))}}]),e}(o.a.Component);rn.contextType=l;var on=rn;var an=function(n){var t=n.data,e=n.theme,a=void 0===e?"white":e,c=Object(r.useContext)(l).actions,u=Object(r.useState)({dragPosition:null}),d=Object(i.a)(u,2),s=d[0],f=(d[1],Object(r.useRef)(null)),b=Object(r.useCallback)((function(n,t,e){c.setFocusedCardIdx(t),c.setFocusedStackIdx(e,{x:n.clientX,y:n.clientY})}),[c.setFocusedStackIdx,c.setFocusedCardIdx]),m=Object(r.useCallback)((function(n,t){var e=n.clientX,r=n.clientY;c.holdCard(t,{x:e,y:r})}),[c.holdCard,c.dropCard]);return o.a.createElement(A,{data:t,theme:a,onMouseDown:m,onMouseOver:b,cardRef:f,inHand:!0,position:{x:0,y:0},dragPosition:s.dragPosition,stackStyle:"hand"})};function cn(){var n=Object(u.a)(["\n  position:absolute;\n  width:100%;\n  height:6rem;\n  bottom:0px;\n\n  background-color:black;\n  border-top: 1rem solid white;\n"]);return cn=function(){return n},n}var un={};un.Hand=d.b.div(cn());var dn=function(){var n=Object(r.useContext)(l).hand,t=Object(r.useMemo)((function(){return n.filter((function(n){return n.status===f.HAND})).map((function(n,t){return Object(s.a)(Object(s.a)({},n),{},{handPosition:t})}))}),[n]);return o.a.createElement(un.Hand,{id:"hand"},t.map((function(n){return o.a.createElement(an,{data:n,key:n.cardIdx})})))},ln=0,sn=function(n){try{return n&&0!==n.length?n[n.length-1].cardIdx+1:0}catch(t){return console.error("couldnt get start index with hand",n),0}},fn={createDeckFromData:function(n,t,e){var r=0;return t.map((function(t){return{title:t.title||"no title",imageUrl:fn.getCompleteCardUrl(t,"./packs/".concat(n)),meta:fn.parseMeta(t.meta,e),deckIdx:r++}})).flat()},parseMeta:function(n,t){return n?n.map((function(n){return{tag:n[0],value:n[1],type:typeof n[1],score:t[n[0]]||0}})):[]},produceCard:function(n,t,e,r,o){var a=fn.filterDeckToWhatsLeft(e,t,r);if(!a||0===a.length)return console.warn("the deck is empty!"),null;var c=a[Math.floor(Math.random()*a.length)],u={x:250+(ln+=2),y:200+ln};return{cardIdx:n,deckIdx:c.deckIdx,info:c,status:f.HAND,layer:o,position:u}},getCardAtIdx:function(n,t){var e=n[t];return e||null},filterDeckToWhatsLeft:function(n,t,e){return e||(e=[]),t.filter((function(t,r){return!(n.find((function(n){return n.deckIdx===t.deckIdx}))||e.indexOf(t.deckIdx)>-1)}))},produceHand:function(n,t,e,r){var o=[],a=[],c=0;void 0===r&&(r=1),e?c=sn(e):e=[];for(var u=0;u<n;u++){var i=fn.produceCard(u+c,t,e,a,r++);i&&a.push(i.deckIdx),i&&o.push(i)}return o},produceDeckHand:function(n,t,e){var r=[],o=[],a=0;void 0===e&&(e=1),t?a=sn(t):t=[];for(var c=0;c<n.length;c++){var u=fn.produceCard(c+a,n,t,o,e++);u&&o.push(u.deckIdx),u&&r.push(u)}return r},getCompleteCardUrl:function(n,t){return n.assetPath?"".concat(t,"/assets/").concat(n.assetPath):n.imageUrl?n.imageUrl:"./assets/cards/sample.jpg"}},bn={rounds:[],cardPack:[],scoreMap:[],name:null},mn={setRoundData:function(n,t){bn.rounds=n},setCardPackData:function(n,t,e){bn.scoreMap=t,bn.name=e;var r=0;bn.cardPack=n.map((function(n){return{id:n.id,title:n.title||"no title",imageUrl:fn.getCompleteCardUrl(n,"./packs/".concat(e)),meta:fn.parseMeta(n.meta,t),deckIdx:r++}})).flat()},getAdjacentRoundIdx:function(n,t){var e=n+t;return e<0?(console.log("round is below 0!"),-1):bn.rounds.length>e?e:(console.log("no more rounds!"),-1)},getRound:function(n){try{return bn.rounds[n]}catch(t){console.error("could not retrieve current round")}},getRoundDeck:function(n){if(console.log("getRoundDeck"),isNaN(n))return console.error("getRoundDeck missing valid roundIdx",n),[];if(mn.getRound(n).deck){var t=mn.getRound(n).deck;return mn.getCardPack().filter((function(n){return t.indexOf(n.id)>-1}))}return mn.getCardPack()},getRoundData:function(n){console.log("getRoundData",n,bn.rounds);try{return{idx:n,targetScore:bn.rounds[n].targetScore,title:bn.rounds[n].title}}catch(t){return{idx:-1,targetScore:2e3}}},getStore:function(){return bn},getCardPack:function(){return bn.cardPack},getNumRounds:function(){return bn.rounds.length}};function gn(){var n=Object(u.a)(["\n    background-color: ",";\n  "]);return gn=function(){return n},n}function pn(){var n=Object(u.a)(["\n  display:inline-block;\n  padding: .5rem 1.5rem;\n  margin:.5rem;\n  font-size: 1rem;\n  background-color: ",";\n  border-radius: 1rem;\n  font-weight: bold;\n  cursor:pointer;\n\n  border: .5rem solid ",";\n  color:",";\n  &:first-child{\n    margin-top:0;\n  }\n\n  &:hover{\n    background-color: ",";\n    /* color:","; */\n    box-shadow: 0 0 1rem .2rem white;\n  }\n\n  ","\n"]);return pn=function(){return n},n}function vn(){var n=Object(u.a)(["\n  font-size:1rem;\n"]);return vn=function(){return n},n}function hn(){var n=Object(u.a)(["\n\n"]);return hn=function(){return n},n}function On(){var n=Object(u.a)(["\n  position:absolute;\n  padding-top: 1rem;\n  top:100%;\n  width:100%;\n  left:0;\n  text-align:center;\n  color:","\n"]);return On=function(){return n},n}function xn(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:-1;\n  left:0;\n  top:0;\n  right:0;\n  bottom:0;\n"]);return xn=function(){return n},n}function jn(){var n=Object(u.a)(["\n  /* padding:1rem; */\n"]);return jn=function(){return n},n}var kn={};function Cn(n){var t=n.roundIdx,e=n.onClick,r=n.isActive;return o.a.createElement(kn.BasicButton,{isActive:r,onClick:function(){return e(t)},role:"button"},"".concat(t+1))}kn.Container=d.b.div(jn()),kn.Bg=d.b.div(xn()),kn.TextArea=d.b.div(On(),b("white")),kn.ZoneText=d.b.p(hn()),kn.CardCount=d.b.p(vn()),kn.BasicButton=d.b.div(pn(),b("purple"),b("white"),b("white"),b("green"),b("blue"),(function(n){return n.isActive&&Object(d.a)(gn(),b("blue"))}));var En=function(){var n=Object(r.useContext)(l),t=n.roundData,e=n.deck,a=n.hand,c=n.actions,u=Object(r.useMemo)((function(){return e.length-a.length}),[e.length,a.length]);return o.a.createElement(kn.Container,null,o.a.createElement(kn.BasicButton,{onClick:function(){return c.prevRound()},role:"button"},"-"),function(n){for(var e=[],r=function(n){e.push(o.a.createElement(Cn,{key:n,roundIdx:n,isActive:t.idx===n,onClick:function(){return c.setRound(n)}}))},a=0;a<n;a++)r(a);return e}(mn.getNumRounds()),o.a.createElement(kn.BasicButton,{onClick:function(){return c.nextRound()},role:"button"},"+"),o.a.createElement(kn.TextArea,null,o.a.createElement(kn.ZoneText,null,"Round: ".concat(t.idx+1,': "').concat(t.title,'"')),o.a.createElement(kn.CardCount,null,"".concat(u," cards left"))),o.a.createElement(kn.Bg,null))};function wn(){var n=Object(u.a)(["\n  >p{\n    /* label */\n    &:nth-child(1){\n      color:white;\n    }\n    /* the score  */\n    &:nth-child(2){\n      font-size: 2rem;\n      color:",";\n    }\n  }\n"]);return wn=function(){return n},n}function In(){var n=Object(u.a)(["\n  >p{\n    &:nth-child(1){\n      font-size:1.5rem;\n      color:",";\n    }\n\n    /* the score  */\n    &:nth-child(2){\n      font-size: 3rem;\n      margin-top: -1.5rem;\n      color:",";\n    }\n  }\n"]);return In=function(){return n},n}function yn(){var n=Object(u.a)(["\n  >p{\n    &:nth-child(1){\n      font-size:2.5rem;\n      color:",";\n    }\n\n    /* the score  */\n    &:nth-child(2){\n      font-size: 5rem;\n      margin-top: -2.5rem;\n      margin-bottom: -1.5rem;\n      color:",";\n    }\n  }\n"]);return yn=function(){return n},n}function Dn(){var n=Object(u.a)(["\n  text-align:right;\n"]);return Dn=function(){return n},n}function Sn(){var n=Object(u.a)(["\n  position:absolute;\n  left:0;\n  top:0;\n  right:0;\n  bottom:0;\n  border: 2rem solid ",";\n  background-color:",";\n  border-radius: 50%;\n  z-index:-1;\n\n  &:hover{\n    box-shadow: 0 0 1rem .2rem ",";\n  }\n"]);return Sn=function(){return n},n}function Rn(){var n=Object(u.a)(["\n  padding-right:11rem;\n  padding-top:10rem;\n  font-size:1rem;\n"]);return Rn=function(){return n},n}var Bn={};Bn.Container=d.b.div(Rn()),Bn.Bg=d.b.div(Sn(),b("white"),b("blue"),b("white")),Bn.ScoreGroup=d.b.div(Dn()),Bn.TotalScore=d.b.div(yn(),b("white"),b("ui_blue")),Bn.TargetScore=d.b.div(In(),b("white"),b("ui_orange")),Bn.SubScore=d.b.div(wn(),b("blue"));var Mn=function(){var n=Object(r.useContext)(l),t=n.stacks,e=n.hand,a=n.roundData,c=Object(r.useMemo)((function(){return G(t,e)}),[t,e]),u=Object(r.useMemo)((function(){return _(c)}),[c]);return Object(r.useMemo)((function(){return Z(u,e.length)}),[u,e.length]),o.a.createElement(Bn.Container,null,o.a.createElement(Bn.ScoreGroup,null,o.a.createElement(Bn.TotalScore,null,o.a.createElement("p",null,"TOTAL"),o.a.createElement("p",null,u)),o.a.createElement(Bn.TargetScore,null,o.a.createElement("p",null,"TARGET"),o.a.createElement("p",null,a.targetScore))),o.a.createElement(Bn.Bg,null))};function An(){var n=Object(u.a)(["\n  position:absolute;\n  left:0;\n  top:0;\n"]);return An=function(){return n},n}function Ln(){var n=Object(u.a)([""]);return Ln=function(){return n},n}function zn(){var n=Object(u.a)(["\n  width: 2000px;\n  top:0;\n  left:0;\n"]);return zn=function(){return n},n}function Tn(){var n=Object(u.a)(["\n  position: absolute;\n  top:0;\n  left:0;\n  background-color: ",";\n  width:100%;\n  height:100%;\n  z-index:-9999999;\n"]);return Tn=function(){return n},n}function Hn(){var n=Object(u.a)(["\n  position:absolute;\n  bottom:0rem;\n  left:0rem;\n  width: 100%;\n  height: 13rem;\n"]);return Hn=function(){return n},n}function Pn(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:1;\n  bottom: 0rem;\n  right: 0rem;\n  width: 46rem;\n  height: 30rem;\n"]);return Pn=function(){return n},n}function Fn(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:99999999;\n  top:-12rem;\n  right:-10rem;\n  width: 30rem;\n  height: 30rem;\n  pointer-events:none;\n"]);return Fn=function(){return n},n}function Nn(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:99999999;\n  top:1rem;\n  left:16rem;\n  right:20rem;\n"]);return Nn=function(){return n},n}function _n(){var n=Object(u.a)(["\n  position:absolute;\n  z-index:99999999;\n  top:1rem;\n  left:1rem;\n"]);return _n=function(){return n},n}function Zn(){var n=Object(u.a)(["\n  position:relative;\n  width:100%;\n  height:100%;\n  overflow:hidden;\n"]);return Zn=function(){return n},n}function Gn(){var n=Object(u.a)(["\n  position:absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  text-align:center;\n  z-index:2;\n"]);return Gn=function(){return n},n}var Wn={};Wn.Board=d.b.div(Gn()),Wn.PlayArea=d.b.div(Zn()),Wn.DrawZone=d.b.div(_n()),Wn.RoundZone=d.b.div(Nn()),Wn.InfoZone=d.b.div(Fn()),Wn.StackInfoZone=d.b.div(Pn()),Wn.DiscardZone=d.b.div(Hn()),Wn.Bg=d.b.div(Tn(),b("black")),Wn.BgImage=d.b.img(zn()),Wn.CardContainer=d.b.div(Ln()),Wn.HeldCardContainer=d.b.div(An());var Un=function(){var n=Object(r.useContext)(l),t=n.actions,e=n.hand,a=n.dataLoaded,c=Object(r.useState)(null),u=Object(i.a)(c,2),d=u[0],s=u[1],b=Object(r.useCallback)((function(){t.setFocusedStackIdx(-1),t.setFocusedCardIdx(-1)}),[t.setFocusedStackIdx,t.setFocusedCardIdx]);Object(r.useEffect)((function(){var n=new URLSearchParams(window.location.search).get("pack");n?t.loadData(n):t.loadData()}),[t.loadData]);var m=Object(r.useMemo)((function(){return e.filter((function(n){return n.status>f.HAND&&n.status<f.DISCARDED}))}),[e]),g=function(n,t){var e=Object(r.useState)(n),o=Object(i.a)(e,2),a=o[0],c=o[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){return c(n)}),t);return function(){return clearTimeout(e)}}),[n,t]),a}(d,50);return Object(r.useEffect)((function(){t.setMouseCoords(g)}),[g,t.setMouseCoords]),a?o.a.createElement(Wn.Board,{onMouseMove:function(n){return s({x:n.clientX,y:n.clientY})}},o.a.createElement(dn,null),o.a.createElement(Wn.DrawZone,null,o.a.createElement(K,null)),o.a.createElement(Wn.RoundZone,null,o.a.createElement(En,null)),o.a.createElement(Wn.InfoZone,null,o.a.createElement("p",null,"info"),o.a.createElement(Mn,null)),o.a.createElement(Wn.DiscardZone,null,o.a.createElement(on,{action:"discard"})),o.a.createElement(Wn.CardContainer,{id:"cc"},m.map((function(n,t){return o.a.createElement(L,{data:n,key:n.cardIdx})}))),o.a.createElement(Wn.Bg,{onMouseOver:b},o.a.createElement(Wn.BgImage,{src:"./assets/bg/space.jpg"}))):o.a.createElement("h1",null,"Loading...")},Xn=function(n,t){console.log("loading data ".concat(n,"..."));var e=new XMLHttpRequest;e.open("GET",n),e.send(null),e.onreadystatechange=function(){try{if(4===e.readyState)if(200===e.status){console.log("...data was loaded!");var r=JSON.parse(e.responseText);t(r)}else console.error("Error loading data from ".concat(n,". Perhaps the file is not found?: "),e.status)}catch(o){console.error("Error loading data from ".concat(n,". Perhaps the JSON is malformed?"),o)}}},Yn=0;var Jn=function(n){var t=n.children,e=Object(r.useState)(-1),a=Object(i.a)(e,2),c=a[0],u=a[1],d=Object(r.useState)(-1),b=Object(i.a)(d,2),m=b[0],g=b[1],p=Object(r.useState)(null),v=Object(i.a)(p,2),h=v[0],O=v[1],x=Object(r.useState)(null),j=Object(i.a)(x,2),k=j[0],C=j[1],E=Object(r.useState)(-1),w=Object(i.a)(E,2),I=w[0],y=w[1],D=Object(r.useState)([]),S=Object(i.a)(D,2),R=S[0],B=S[1],M=Object(r.useState)([]),A=Object(i.a)(M,2),L=A[0],z=A[1],T=Object(r.useState)([]),H=Object(i.a)(T,2),F=H[0],N=H[1],_=Object(r.useState)([]),Z=Object(i.a)(_,2),G=Z[0],W=Z[1],U=Object(r.useState)(!1),X=Object(i.a)(U,2),Y=X[0],J=X[1],K=Object(r.useState)({}),V=Object(i.a)(K,2),q=V[0],$=V[1],Q=Object(r.useCallback)((function(n){$(mn.getRoundData(n))}),[$]),nn=Object(r.useCallback)((function(n){var t="./packs/".concat(n=n||"traditional","/data.json");Xn(t,(function(n){try{console.log("heres your data",n),mn.setRoundData(n.pack.rounds),mn.setCardPackData(n.pack.cards,n.pack.scoreMap,n.pack.name);Q(0),z(mn.getRoundDeck(0)),J(!0)}catch(t){console.error("problem intializing data",t)}}))}),[J,Q]),tn=Object(r.useCallback)((function(n,t){var e=P.calcStacks(n);W(e);var r=n.map((function(n){return Object(s.a)(Object(s.a)({},n),{},{stackIdx:e.findIndex((function(t){return t.indexOf(n.cardIdx)>-1}))})}));B(r),t>-1&&g(r.find((function(n){return n.cardIdx===t})).stackIdx)}),[B,W,g]),en=Object(r.useCallback)((function(n){tn(R.filter((function(t){return t.cardIdx!==n})))}),[tn,R]),rn=Object(r.useCallback)((function(n){Yn=1;var t=fn.produceHand(L.length-(n||0),mn.getRoundDeck(q.idx),[],Yn);Yn+=t.length,tn(t)}),[tn,q.idx,L]),on=Object(r.useCallback)((function(n){var t=fn.produceHand(n,mn.getRoundDeck(q.idx),R,Yn);Yn+=t.length,tn(R.concat(t))}),[tn,R,q.idx]),an=Object(r.useCallback)((function(){Yn=1,tn([])}),[tn]),cn=Object(r.useCallback)((function(){if(R.length>0){var n=Math.floor(Math.random()*R.length);en(R[n].cardIdx)}}),[en,R]),un=Object(r.useCallback)((function(n,t){F.find((function(t){return t.id===n}))?N(F.map((function(e){return e.id===n?Object(s.a)(Object(s.a)({},e),{},{bounds:{top:t.top,left:t.left,right:t.right,bottom:t.bottom}}):e}))):N(F.concat([{id:n,bounds:{top:t.top,left:t.left,right:t.right,bottom:t.bottom}}]))}),[F,N]),dn=Object(r.useCallback)((function(){var n=mn.getAdjacentRoundIdx(q.idx,1);n>-1?(an(),Q(n),z(mn.getRoundDeck(n))):console.log("nextRound, end of rounds!")}),[q.idx,Q,an]),ln=Object(r.useCallback)((function(){var n=mn.getAdjacentRoundIdx(q.idx,-1);n>-1?(an(),Q(n),z(mn.getRoundDeck(n))):console.log("nextRound, end of rounds!")}),[q.idx,Q,an]),sn=Object(r.useCallback)((function(n){mn.getRound(n)?(an(),Q(n),z(mn.getRoundDeck(n))):console.log('setRound, roundIdx "'.concat(n,'" not found'))}),[Q,an]),bn=function(n,t){return f[t]?f[t]:n===f.HAND_HOLDING?f.HAND:n===f.TABLE_HOLDING?f.TABLE:n},gn=Object(r.useCallback)((function(n,t){u(n),tn(R.map((function(e){if(e.cardIdx===n)return Object(s.a)(Object(s.a)({},e),{},{status:(r=e.status,r===f.HAND?f.HAND_HOLDING:r===f.TABLE?f.TABLE_HOLDING:r),position:t||e.position});var r,o=bn(e.status);return e.status!==o?Object(s.a)(Object(s.a)({},e),{},{status:o}):e})))}),[u,R,tn]),pn=Object(r.useCallback)((function(n){tn(R.map((function(t){return t.cardIdx===n?Object(s.a)(Object(s.a)({},t),{},{status:f.HAND}):t})))}),[u,R,tn]),vn=Object(r.useCallback)((function(n,t){g(n),O(t||null)}),[g,O]),hn=Object(r.useCallback)((function(n,t,e){u(-1),n===c&&u(-1);var r=R.find((function(t){return t.cardIdx===n}));if(r&&"TABLE"===t){var o=[];if(r&&(o=function(n,t){return t.filter((function(t){return n.x>t.bounds.left&&n.x<t.bounds.right&&n.y>t.bounds.top&&n.y<t.bounds.bottom}))}(e,F)),o.find((function(n){return"hand"===n.id})))return void pn(n)}tn(R.map((function(r){return r.cardIdx===n?Object(s.a)(Object(s.a)({},r),{},{status:bn(r.status,t),layer:Yn++,position:e?{x:e.x,y:e.y}:r.position}):r})))}),[u,R,tn,c,F,pn]);return o.a.createElement(l.Provider,{value:{dataLoaded:Y,deck:L,hand:R,stacks:G,zones:F,roundData:q,holdingIdx:c,focusedStackIdx:m,focusedCardIdx:I,tooltipCoords:h,mouseCoords:k,actions:{nextRound:dn,prevRound:ln,setRound:sn,dealHand:rn,dealCard:on,discardCard:en,discardRandomCard:cn,discardHand:an,loadData:nn,setZone:un,setHoldingIdx:u,setFocusedStackIdx:vn,setFocusedCardIdx:y,setMouseCoords:C,holdCard:gn,dropCard:hn,placeCardInHand:pn}}},t)};function Kn(){var n=Object(u.a)(["\n  color:white;\n"]);return Kn=function(){return n},n}function Vn(){var n=Object(u.a)(["\n  font-size:1.25rem;\n"]);return Vn=function(){return n},n}function qn(){var n=Object(u.a)(["\n\n"]);return qn=function(){return n},n}function $n(){var n=Object(u.a)(["\n  flex: 1 0 20%;\n  text-align:right;\n"]);return $n=function(){return n},n}function Qn(){var n=Object(u.a)(["\n  border:2px solid white;\n  background-color: ",";\n  border-radius:1rem;\n  padding:1rem;\n"]);return Qn=function(){return n},n}function nt(){var n=Object(u.a)(["\n  color:white;\n  display:flex;\n"]);return nt=function(){return n},n}function tt(){var n=Object(u.a)(["\n    opacity:1;\n  "]);return tt=function(){return n},n}function et(){var n=Object(u.a)(["\n  opacity:0;\n  font-size:1.5rem;\n\n  ","\n\n  background-color:black;\n  border:5px solid white;\n  border-radius:2rem;\n  padding:.5rem 1rem;\n  padding-top:0;\n  min-width: 20rem;\n\n  ul{\n    list-style:none;\n\t  margin-left: 0;\n\t  padding-left: 0;\n  }\n"]);return et=function(){return n},n}function rt(){var n=Object(u.a)(["\n  position:absolute;\n  transition: top .2s, left: .2s;\n"]);return rt=function(){return n},n}function ot(){var n=Object(u.a)(["\n  position:fixed;\n  pointer-events:none;\n  top:0;\n  left:0;\n  z-index:3;\n"]);return ot=function(){return n},n}var at={};function ct(n){var t=n.data;return o.a.createElement(at.MetaLine,null,o.a.createElement(at.MetaTag,null,o.a.createElement(at.MetaTagLabel,null,"".concat(t.tag,":")),o.a.createElement(at.MetaTagValue,null,"".concat(t.value.toString()))),o.a.createElement(at.MetaScore,null,o.a.createElement("p",null,t.score)))}function ut(n){var t=n.stack;return t?o.a.createElement(at.StackEntry,{isActive:!!t},t.meta.length>0?o.a.createElement("ul",null,t.meta.map((function(n,t){return o.a.createElement(ct,{key:t,data:n})}))):o.a.createElement("ul",null,o.a.createElement("li",null,"no matching tags")),o.a.createElement(at.StackTotal,null,o.a.createElement("span",null,t.count),o.a.createElement("span",null," cards x "),o.a.createElement("span",null,t.subScore),o.a.createElement("span",null,"= "),o.a.createElement("span",null,t.score))):o.a.createElement(at.StackEntry,{isActive:!1})}at.Tooltips=d.b.div(ot()),at.Tooltip=d.b.div(rt()),at.StackEntry=d.b.div(et(),(function(n){return n.isActive&&Object(d.a)(tt())})),at.MetaLine=d.b.li(nt()),at.MetaTag=d.b.div(Qn(),b("blue")),at.MetaScore=d.b.div($n()),at.MetaTagLabel=d.b.p(qn()),at.MetaTagValue=d.b.p(Vn()),at.StackTotal=d.b.div(Kn());var it=function(n){n.data;var t=Object(r.useContext)(l),e=t.mouseCoords,a=t.stacks,c=t.hand,u=t.focusedStackIdx,i=Object(r.useMemo)((function(){return e?{left:e.x,top:e.y}:null}),[e]),d=Object(r.useMemo)((function(){return G(a,c)}),[a,c]),s=Object(r.useMemo)((function(){return d.find((function(n){return n.idx===u}))}),[d,u]);return o.a.createElement(at.Tooltips,null,o.a.createElement(at.Tooltip,{style:i,isActive:!!s},o.a.createElement(ut,{stack:s})))};function dt(){var n=Object(u.a)(["\n  position:absolute;\n  width:100%;\n  height:100%;\n  overflow:hidden;\n"]);return dt=function(){return n},n}var lt={};lt.Container=d.b.div(dt()),window.gm=mn,window.dm=fn;var st=function(){return o.a.createElement(lt.Container,null,o.a.createElement(Jn,null,o.a.createElement(it,null),o.a.createElement(Un,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(st,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()})).catch((function(n){console.error(n.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.0b55470d.chunk.js.map